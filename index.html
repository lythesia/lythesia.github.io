<!DOCTYPE HTML>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>&gt;&gt; _</title>
  <meta name="author" content="lythesia">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="&gt;&gt; _"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="&gt;&gt; _" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
  <link href="http://apps.bdimg.com/libs/fontawesome/4.1.0/css/font-awesome.css" rel="stylesheet" type="text/css"><!-- hexo-inject:begin --><link href='/cplayer/cp.min.css' rel='stylesheet'><script src='/cplayer/cp.min.js' type='text/javascript'></script><!-- hexo-inject:end -->
</head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">&gt;&gt; _</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    
      <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-15T15:43:07.000Z"><a href="/2017/04/15/papas-room/"><i>2017-04-15</i></a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/15/papas-room/">Papa&#39;s room</a></h1>
  

    </header>
    <div class="entry">
      
        <h3 id="QUARTET-PAPAS-クァルテットパパス"><a href="#QUARTET-PAPAS-クァルテットパパス" class="headerlink" title="QUARTET  PAPAS  クァルテットパパス"></a>QUARTET  PAPAS  クァルテットパパス</h3><p><img src="http://yyphoto.qiniudn.com/image/articlepapas.jpg" alt="Quartet Papas"></p>
<blockquote>
<p>1stviolin 粟津惇<br>2ndviolin 青山英里香<br>viola 武田麻耶<br>cello 奥村景</p>
<p>2012年、桐朋学園大学の同期生で結成。<br>クラシック音楽と共に、映画、ゲーム音楽、プログレ、アイリッシュ。メンバーの好物をあらゆる方面から探し出し、オリジナルアレンジを基本にレパートリーを広げている。<br>定期コンサートの傍ら、アウトリーチコンサートツアー、アーティストのレコーディング、現代曲初演など精力的に活動中。</p>
</blockquote>
<div id="cplayer-here" style="margin-top:10px;"></div>
     <script>
     'use strict';
      let cp = new cPlayer({
        "element":document.getElementById("cplayer-here"),
        "list":[{"name":"BLESSING ～愛死天ROOのテーマ～","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/01.m4a"},{"name":"La Veillée","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/02.m4a"},{"name":"Music For A Found Harmonium","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/03.m4a"},{"name":"アヴェ・マリア","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/04.m4a"},{"name":"モルダウ(「わが祖国」より)","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/05.m4a"},{"name":"弦楽四重奏曲第14番「死と乙女」第1楽章より","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/06.m4a"},{"name":"弦楽四重奏曲第14番「死と乙女」第4楽章より","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/07.m4a"},{"name":"ドラゴンクエスト序曲","artist":"QUARTET PAPAS","image":"http://106.2.123.67/papas-room/cover.jpg","url":"http://106.2.123.67/papas-room/bonus.mp3"}]
      })
     </script>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-12-11T13:26:58.000Z"><a href="/2014/12/11/ruby-programming-language-ch8/"><i>2014-12-11</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/12/11/ruby-programming-language-ch8/">ruby programming language(ch8)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Ch8"><a href="#Ch8" class="headerlink" title="Ch8"></a>Ch8</h1><h2 id="type-class-module"><a href="#type-class-module" class="headerlink" title="type,class,module"></a>type,class,module</h2><h3 id="ancestry"><a href="#ancestry" class="headerlink" title="ancestry"></a>ancestry</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="class"><span class="keyword">module</span>&gt;.<span class="title">ancestors</span> <span class="comment"># =&gt; modules</span></span></div><div class="line">&lt;<span class="class"><span class="keyword">class</span>&gt;.<span class="title">ancestors</span>  <span class="comment"># =&gt; self, modules, superclass .. Object, Kernel(module)</span></span></div><div class="line"></div><div class="line">&lt;<span class="class"><span class="keyword">module</span>&gt;.<span class="title">included_modules</span> <span class="comment"># =&gt; ..</span></span></div><div class="line">&lt;<span class="class"><span class="keyword">class</span>&gt;.<span class="title">included_modules</span>  <span class="comment"># =&gt; .. Kernel</span></span></div></pre></td></tr></table></figure>
<h3 id="def"><a href="#def" class="headerlink" title="def"></a>def</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">M = Module.new</div><div class="line">D = Class.new(C) &#123; <span class="keyword">include</span> M &#125;</div></pre></td></tr></table></figure>
<h2 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h2><h3 id="binding-amp-eval"><a href="#binding-amp-eval" class="headerlink" title="binding &amp; eval"></a>binding &amp; eval</h3><p><code>eval 1 [2]</code>:</p>
<ol>
<li>eval string</li>
<li><strong>Binding</strong> object</li>
</ol>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">eval(.., obj.binding) <span class="comment"># obj.binding.eval(..), make sure `binding` return the binding object</span></div><div class="line">eval(..) <span class="comment"># Kernel.eval(..) or eval(.., Kernel.binding)</span></div></pre></td></tr></table></figure>
<h3 id="instance-eval-amp-clas-eval"><a href="#instance-eval-amp-clas-eval" class="headerlink" title="instance_eval &amp; clas_eval"></a>instance_eval &amp; clas_eval</h3><ul>
<li>code evaluated in <strong>correspond</strong> context (to instance or class object)</li>
<li>both can accept <strong>block</strong> instead of string </li>
</ul>
<h2 id="reflect-var"><a href="#reflect-var" class="headerlink" title="reflect var"></a>reflect var</h2><ul>
<li><code>&lt;instance&gt;.instance_variables</code></li>
<li><code>&lt;class&gt;.class_variables</code></li>
<li><p><code>class.constants</code></p>
</li>
<li><p>query: <code>eval(&quot;.. #{..} ..&quot;)</code></p>
</li>
<li>attr: <code>o.instance_variable_set(:@x, 0)</code> <code>o.instance_variable_get(:@x)</code>, similar <code>class_xxx</code> <code>const_xxx</code></li>
<li>test: <code>_defined?</code> <code>_missing?</code></li>
</ul>
<h2 id="method"><a href="#method" class="headerlink" title="method"></a>method</h2><ul>
<li><code>.methods</code> == <code>.public_methods</code></li>
<li><code>.protected_methods</code> <code>.private_methods</code></li>
<li><code>&lt;class&gt;.instance_methods</code> alternative prefix: <code>public</code> <code>protected</code> <code>private</code></li>
<li><code>.singleton_methods</code><ul>
<li>trivial for instance</li>
<li>class methods for class</li>
</ul>
</li>
<li><code>methods</code> gives list, with <code>(false)</code> to exclude inherited</li>
<li><code>method(:sym)</code> to get method object<ul>
<li><code>&lt;method&gt;.call ..</code></li>
<li><code>&lt;object&gt;.send(:sym, ..)</code></li>
</ul>
</li>
</ul>
<h3 id="define"><a href="#define" class="headerlink" title="define"></a>define</h3><p>instance:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_method</span><span class="params">(c, m, &amp;b)</span></span></div><div class="line">  c.class_eval &#123;</div><div class="line">    <span class="comment"># private, must be inside class/module</span></div><div class="line">    <span class="comment"># `.class_eval` provides this context</span></div><div class="line">    define_method(m, &amp;b)</div><div class="line">  &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">add_method(String, <span class="symbol">:greet</span>) &#123; <span class="string">"Hello, "</span> + <span class="keyword">self</span> &#125;</div><div class="line"><span class="string">"world"</span>.greet <span class="comment"># =&gt; "Hello, world"</span></div></pre></td></tr></table></figure>
<p>class:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add_class_method</span><span class="params">(c, m, &amp;b)</span></span></div><div class="line">  eigenclass = <span class="class"><span class="keyword">class</span> &lt;&lt; c;</span> <span class="keyword">self</span>; <span class="keyword">end</span></div><div class="line">  eigenclass.class_eval &#123;</div><div class="line">    define_method(m, &amp;b)</div><div class="line">  &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">add_class_method(..)</div><div class="line">String.greet(<span class="string">"world"</span>) <span class="comment"># =&gt; "Hello, world"</span></div></pre></td></tr></table></figure>
<p>or </p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">String.define_singleton_method(<span class="symbol">:greet</span>) &#123;..&#125;</div></pre></td></tr></table></figure>
<p>eigenclass gets the class object, recall a specified class is a instance</p>
<h2 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h2><p>when:</p>
<ul>
<li>classes are subclassed</li>
<li>modules are included</li>
<li>methods are defined</li>
<li>..</li>
</ul>
<table>
<thead>
<tr>
<th><code>ed</code> method</th>
<th>when</th>
<th>param</th>
<th>extra</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>inherited</code></td>
<td>new class defined</td>
<td>new class object</td>
<td>inherited by subclass</td>
</tr>
<tr>
<td><code>included</code></td>
<td>module included</td>
<td>class or module object included in</td>
<td></td>
</tr>
<tr>
<td><code>extended</code></td>
<td>object extended</td>
<td>..</td>
<td></td>
</tr>
<tr>
<td><code>method_added</code></td>
<td>instance method</td>
<td>:”new method name”</td>
<td></td>
</tr>
<tr>
<td><code>singleton_..</code></td>
<td>singleton/class method</td>
<td>:”singleton_method”</td>
<td>self invoked when define</td>
</tr>
</tbody>
</table>
<p>others:</p>
<ul>
<li><code>removed/undefined</code></li>
<li><code>singleton_removed/_undefined</code></li>
</ul>
<h2 id="tracing"><a href="#tracing" class="headerlink" title="tracing"></a>tracing</h2><ul>
<li><code>__FILE__</code></li>
<li><code>__LINE__</code></li>
<li><code>SCRIPT_LINES__</code>: hash { filename: array of lines of source file } filled when <code>require</code> and <code>load</code><ul>
<li>include main file: <code>SCRIPT_LINES__ = {__FILE__ =&gt; File.readlines(__FILE__)}</code></li>
<li>refer line of code: <code>SCRIPT_LINES__[__FILE__][__LINE__-1]</code></li>
</ul>
</li>
<li><code>trace_var(:var)</code>: when changed</li>
</ul>
<h2 id="ObjectSpace"><a href="#ObjectSpace" class="headerlink" title="ObjectSpace"></a>ObjectSpace</h2><ul>
<li><code>.each_object</code></li>
<li><code>.id2ref</code> inverse to <code>.object_id</code></li>
<li>..</li>
</ul>
<h2 id="def-method-dynamically"><a href="#def-method-dynamically" class="headerlink" title="def method dynamically"></a>def method dynamically</h2><h3 id="class-eval"><a href="#class-eval" class="headerlink" title="class_eval"></a>class_eval</h3><p>directly interpolate identifiers into method body</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Module</span></span></div><div class="line">  private</div><div class="line">  </div><div class="line">  <span class="comment"># alias attr_reader</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">readonly</span><span class="params">(*syms)</span></span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">if</span> syms.size == <span class="number">0</span></div><div class="line">    code = <span class="string">""</span>       <span class="comment"># final code to eval</span></div><div class="line">    syms.each &#123;<span class="params">|s|</span> code &lt;&lt; <span class="string">"def <span class="subst">#&#123;s&#125;</span>; @<span class="subst">#&#123;s&#125;</span>; end\n"</span>&#125; <span class="comment"># code for getter</span></div><div class="line">    class_eval code <span class="comment"># eval to define</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="comment"># alias attr_accessor</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">readwrite</span><span class="params">(*syms)</span></span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">if</span> syms.size == <span class="number">0</span></div><div class="line">    code = <span class="string">""</span></div><div class="line">    syms.each <span class="keyword">do</span> <span class="params">|s|</span></div><div class="line">      code &lt;&lt; <span class="string">"def <span class="subst">#&#123;s&#125;</span>; @<span class="subst">#&#123;s&#125;</span>; end\n"</span></div><div class="line">      code &lt;&lt; <span class="string">"def <span class="subst">#&#123;s&#125;</span>=(val); @<span class="subst">#&#123;s&#125;</span> = val; end\n"</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    class_eval code</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="define-method"><a href="#define-method" class="headerlink" title="define_method"></a>define_method</h3><p>rely on reflective methods</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Module</span></span></div><div class="line">  <span class="comment"># init INSTANCE vars with default</span></div><div class="line">  <span class="comment"># e.g: attributes x:0, y:0</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">attributes</span><span class="params">(hash)</span></span></div><div class="line">    hash.each_pair <span class="keyword">do</span> <span class="params">|symbol, default|</span></div><div class="line">      <span class="comment"># symbol name for getter/setter</span></div><div class="line">      getter = symbol</div><div class="line">      setter = <span class="symbol">:<span class="string">"<span class="subst">#&#123;symbol&#125;</span>="</span></span></div><div class="line">      <span class="comment"># symbol name for member var</span></div><div class="line">      variable = <span class="symbol">:<span class="string">"@<span class="subst">#&#123;symbol&#125;</span>"</span></span></div><div class="line">      <span class="comment"># define getter via reflective</span></div><div class="line">      define_method getter <span class="keyword">do</span></div><div class="line">        <span class="keyword">if</span> instance_variable_defined? variable</div><div class="line">          instance_variable_get variable</div><div class="line">        <span class="keyword">else</span></div><div class="line">          default</div><div class="line">        <span class="keyword">end</span></div><div class="line">      <span class="keyword">end</span></div><div class="line">      <span class="comment"># define setter</span></div><div class="line">      define_method setter <span class="keyword">do</span> <span class="params">|val|</span></div><div class="line">        instance_variable_set variable,val</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="comment"># init CLASS vars</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">class_attr</span><span class="params">(hash)</span></span></div><div class="line">    eigenclass = <span class="class"><span class="keyword">class</span> &lt;&lt; self;</span> <span class="keyword">self</span>; <span class="keyword">end</span></div><div class="line">    eigenclass.class_eval &#123; attributes(hash) &#125;</div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  private <span class="symbol">:attributes</span>, <span class="symbol">:class_attrs</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="DSL"><a href="#DSL" class="headerlink" title="DSL"></a>DSL</h2><blockquote>
<p>A DSL is just an extension of Ruby syntax (with methods that look like keywords)<br>or API that allows to solve problem or represent data more naturally.</p>
</blockquote>
<p>XML as example utilized ruby’s:</p>
<ol>
<li>block</li>
<li>parentheses-optinal invoke</li>
<li>passing hash literals without curly braces</li>
<li><code>method_missing</code></li>
</ol>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMLGrammar</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(out)</span></span></div><div class="line">    @out = out</div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="comment"># output as CDATA</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">content</span><span class="params">(text)</span></span></div><div class="line">    @out &lt;&lt; text.to_s</div><div class="line">    <span class="literal">nil</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">comment</span><span class="params">(text)</span></span></div><div class="line">    @out &lt;&lt; <span class="string">"&lt;!-- <span class="subst">#&#123;text&#125;</span> --&gt;"</span></div><div class="line">    <span class="literal">nil</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">tag</span><span class="params">(tagname, attributes=&#123;&#125;)</span></span></div><div class="line">    <span class="comment"># open tag</span></div><div class="line">    @out &lt;&lt; <span class="string">"&lt;<span class="subst">#&#123;tagname&#125;</span>"</span></div><div class="line">    </div><div class="line">    <span class="comment"># attr</span></div><div class="line">    attributes.each &#123;<span class="params">|attr,val|</span> @out &lt;&lt; <span class="string">" <span class="subst">#&#123;attr&#125;</span>='<span class="subst">#&#123;val&#125;</span>'"</span> &#125;</div><div class="line">    </div><div class="line">    <span class="comment"># content</span></div><div class="line">    <span class="keyword">if</span> block_given?</div><div class="line">      @out &lt;&lt; <span class="string">"&gt;"</span></div><div class="line">      content = <span class="keyword">yield</span>   <span class="comment"># invoke block returned as content</span></div><div class="line">      <span class="keyword">if</span> content</div><div class="line">        @out &lt;&lt; content.to_s</div><div class="line">      <span class="keyword">end</span></div><div class="line">      <span class="comment"># close pair</span></div><div class="line">      @out &lt;&lt; <span class="string">"&lt;/<span class="subst">#&#123;tagname&#125;</span>&gt;"</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">      <span class="comment"># close single</span></div><div class="line">      @out &lt;&lt; <span class="string">"/&gt;"</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="literal">nil</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="comment"># ordinary class ==&gt; DSL</span></div><div class="line">  <span class="comment"># Sol 1: &#123; any unknown method is treated as name of tag</span></div><div class="line">  <span class="keyword">alias</span> method_missing tag</div><div class="line">  <span class="comment"># &#125;</span></div><div class="line">  <span class="comment"># run block in new instance of XML class</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">generate</span><span class="params">(out, &amp;block)</span></span></div><div class="line">    XML.new(out).instance_eval(&amp;block)</div><div class="line">  <span class="keyword">end</span></div><div class="line">  </div><div class="line">  <span class="comment"># or</span></div><div class="line">  <span class="comment"># Sol2: &#123; add validation without using `method_missing`</span></div><div class="line">  </div><div class="line">  <span class="comment"># define an allowed element(tag) in one (XML) grammar</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">element</span><span class="params">(tagname, attributes=&#123;&#125;)</span></span></div><div class="line">    @allowed_attributes <span class="params">||</span>= &#123;&#125;</div><div class="line">    @allowed_attributes[tagname] = attributes</div><div class="line">    </div><div class="line">    class_eval <span class="string">%Q&#123;</span></div><div class="line">      def <span class="subst">#&#123;tagname&#125;</span>(attributes=&#123;&#125;, &amp;block)</div><div class="line">        tag(<span class="symbol">:</span><span class="comment">#&#123;tagname&#125;, attributes, &amp;block)</span></div><div class="line">      <span class="keyword">end</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment"># constants indicate type of attribute</span></div><div class="line">    OPT  = <span class="symbol">:opt</span>   <span class="comment"># optional</span></div><div class="line">    REQ  = <span class="symbol">:req</span>   <span class="comment"># required</span></div><div class="line">    BOOL = <span class="symbol">:bool</span>  <span class="comment"># value is own name</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">allowed_attributes</span></span></div><div class="line">      @allowed_attributes</div><div class="line">    <span class="keyword">end</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tag</span><span class="params">(tagname, attributes=&#123;&#125;)</span></span></div><div class="line">      @out &lt;&lt; <span class="string">"&lt;<span class="subst">#&#123;tagname&#125;</span>"</span></div><div class="line"> </div><div class="line">      <span class="comment"># get allowed for current tag</span></div><div class="line">      allowed = <span class="keyword">self</span>.<span class="keyword">class</span>.allowed_attributes[tagname]</div><div class="line">      <span class="comment"># check attribute exist</span></div><div class="line">      attributes.each_pair <span class="keyword">do</span> <span class="params">|k,v|</span></div><div class="line">        raise <span class="string">"unknown attribute: <span class="subst">#&#123;k&#125;</span>"</span> unless allowed.included? k</div><div class="line">        @out &lt;&lt; <span class="string">" <span class="subst">#&#123;k&#125;</span>='<span class="subst">#&#123;v&#125;</span>'"</span></div><div class="line">      <span class="keyword">end</span></div><div class="line">      </div><div class="line">      <span class="comment"># check attribute type</span></div><div class="line">      allowed.each_pair <span class="keyword">do</span> <span class="params">|k,v|</span></div><div class="line">        <span class="comment"># already output</span></div><div class="line">        <span class="keyword">next</span> <span class="keyword">if</span> attributes.has_key? k</div><div class="line">        <span class="keyword">if</span> (v == REQ)</div><div class="line">          raise <span class="string">"required attribute '<span class="subst">#&#123;k&#125;</span>' missing in &lt;<span class="subst">#&#123;tagname&#125;</span>&gt;"</span></div><div class="line">        <span class="keyword">elsif</span> v.is_a? String</div><div class="line">          @out &lt;&lt; <span class="string">" <span class="subst">#&#123;k&#125;</span> = '<span class="subst">#&#123;v&#125;</span>'"</span></div><div class="line">        <span class="keyword">end</span></div><div class="line">      <span class="keyword">end</span></div><div class="line">      </div><div class="line">      <span class="keyword">if</span> block_given?</div><div class="line">        <span class="comment"># same as above</span></div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="comment"># &#125;</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>usage example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># define</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTMLForm</span> &lt; XMLGrammar</span></div><div class="line">  element <span class="symbol">:form</span>, <span class="symbol">:action</span> =&gt; REQ,</div><div class="line">          <span class="symbol">:method</span> =&gt; <span class="string">"GET"</span>,</div><div class="line">          <span class="symbol">:enctype</span> =&gt; <span class="string">"application/x-www-form-urlencoded"</span>,</div><div class="line">          <span class="symbol">:name</span> =&gt; OPT</div><div class="line">  element <span class="symbol">:input</span>, <span class="symbol">:type</span> =&gt; <span class="string">"text"</span>, <span class="symbol">:name</span> =&gt; OPT, <span class="symbol">:value</span> =&gt; OPT,</div><div class="line">          <span class="symbol">:maxlength</span> =&gt; OPT, <span class="symbol">:size</span> =&gt; OPT, <span class="symbol">:src</span> =&gt; OPT,</div><div class="line">          <span class="symbol">:checked</span> =&gt; BOOL, <span class="symbol">:disabled</span> =&gt; BOOL, <span class="symbol">:readonly</span> =&gt; BOOL</div><div class="line">  element <span class="symbol">:textarea</span>, <span class="symbol">:rows</span> =&gt; REQ, <span class="symbol">:cols</span> =&gt; REQ, <span class="symbol">:name</span> =&gt; OPT,</div><div class="line">          <span class="symbol">:disabled</span> =&gt; BOOL, <span class="symbol">:readonly</span> =&gt; BOOL</div><div class="line">  element <span class="symbol">:button</span>, <span class="symbol">:name</span> =&gt; OPT, <span class="symbol">:value</span> =&gt; OPT,</div><div class="line">          <span class="symbol">:type</span> =&gt; <span class="string">"submit"</span>, <span class="symbol">:disabled</span> =&gt; OPT</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># use</span></div><div class="line">HTMLForm.generate(STDOUT) <span class="keyword">do</span></div><div class="line">  comment <span class="string">"This is a simple HTML form"</span></div><div class="line">  form <span class="symbol">:name</span> =&gt; <span class="string">"registration"</span>,</div><div class="line">       <span class="symbol">:action</span> =&gt; <span class="string">"http://www.example.com/register.cgi"</span> <span class="keyword">do</span></div><div class="line">          content <span class="string">"Name:"</span></div><div class="line">          input <span class="symbol">:name</span> =&gt; <span class="string">"name"</span></div><div class="line">          content <span class="string">"Address:"</span></div><div class="line">          textarea <span class="symbol">:name</span> =&gt; <span class="string">"address"</span>, <span class="symbol">:rows=&gt;</span><span class="number">6</span>, <span class="symbol">:cols=&gt;</span><span class="number">40</span> <span class="keyword">do</span></div><div class="line">            <span class="string">"Please enter your mailing address here"</span></div><div class="line">          <span class="keyword">end</span></div><div class="line">          button &#123; <span class="string">"Submit"</span> &#125;</div><div class="line">        <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-12-02T05:28:03.000Z"><a href="/2014/12/02/ruby-programming-language-ch7/"><i>2014-12-02</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/12/02/ruby-programming-language-ch7/">ruby programming language(ch7)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Ch7"><a href="#Ch7" class="headerlink" title="Ch7"></a>Ch7</h1><h2 id="class-def"><a href="#class-def" class="headerlink" title="class def"></a>class def</h2><p>last expression in def is the value of class def(<code>nil</code> if last is a method def)</p>
<h3 id="init"><a href="#init" class="headerlink" title="init"></a>init</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(x,y)</span></span></div><div class="line">    @x,@y = x,y</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="attr"><a href="#attr" class="headerlink" title="attr"></a>attr</h3><ul>
<li><code>attr_reader :x, :y</code></li>
<li><code>attr_accessor &quot;x&quot;, &quot;y&quot;</code></li>
</ul>
<h3 id="duck-type"><a href="#duck-type" class="headerlink" title="duck type"></a>duck type</h3><p>loosen:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">+</span><span class="params">(other)</span></span></div><div class="line">  Point.new(@x + other.x, @y + other.y)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>strict(for duck type):</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">+</span><span class="params">(other)</span></span></div><div class="line">  raise TypeError, <span class="string">"Not Point-like"</span> unless other.respond_to? <span class="symbol">:x</span> <span class="keyword">and</span> other.respond_to? <span class="symbol">:y</span></div><div class="line">  Point.new(..)</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="coerce"><a href="#coerce" class="headerlink" title="coerce"></a>coerce</h3><p>class operation cannot hanle like <code>other_class + self_class</code>:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">coerce</span><span class="params">(other)</span></span></div><div class="line">  <span class="comment"># simply swap self and other, then apply self + other is ok</span></div><div class="line">  [<span class="keyword">self</span>, other]</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">each</span></span></div><div class="line">  <span class="keyword">yield</span> @x</div><div class="line">  <span class="keyword">yield</span> @y</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>thus utilize methods in <code>include Enumerable</code> based on <code>each</code></p>
<h3 id="equality"><a href="#equality" class="headerlink" title="equality"></a>equality</h3><p>equal:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">==</span><span class="params">(o)</span></span></div><div class="line">  @x == o.x &amp;&amp; @y == o.y</div><div class="line"><span class="keyword">rescue</span></div><div class="line">  <span class="literal">false</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>identity:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">eql?</span><span class="params">(o)</span></span></div><div class="line">  <span class="keyword">if</span> o.instance_of? Point</div><div class="line">    @x.eql?(o.x) <span class="keyword">and</span> @y.eql?(o.y)</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="literal">false</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span></span></div><div class="line">  <span class="comment"># trick for hash code generation</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="order"><a href="#order" class="headerlink" title="order"></a>order</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">include</span> Comparable</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">&lt;=&gt;</span><span class="params">(other)</span></span></div><div class="line">  <span class="keyword">return</span> <span class="literal">nil</span> unless other.instance_of? Point</div><div class="line">  <span class="comment"># compare strategy</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="quick-mutable"><a href="#quick-mutable" class="headerlink" title="quick mutable"></a>quick mutable</h3><p>via <code>Struct</code>(core ruby class):</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Struct.new(<span class="string">"Point"</span>, <span class="symbol">:x</span>, <span class="symbol">:y</span>) <span class="comment"># Struct::Point</span></div><div class="line">Point = Struct.new(<span class="symbol">:x</span>, <span class="symbol">:y</span>)</div></pre></td></tr></table></figure>
<h3 id="class-method"><a href="#class-method" class="headerlink" title="class method"></a>class method</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">foo</span></span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># or</span></div><div class="line"><span class="class"><span class="keyword">class</span> &lt;&lt; self</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">foo</span>;</span> ..; <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="var"><a href="#var" class="headerlink" title="var"></a>var</h3><p>constant:</p>
<ul>
<li><code>FOO = Point.new(..)</code> (<code>initialize</code> must be defined before)</li>
<li><code>Point::BAR = ..</code> outside define is ok</li>
</ul>
<p>class var:</p>
<ul>
<li><code>@@</code> init in class def</li>
<li>available in both instance &amp; class method</li>
</ul>
<p>class instance var:</p>
<ul>
<li><code>@</code> init in class def</li>
<li>only available in class method</li>
<li><code>class &lt;&lt; self; attr_accessor :..; end</code></li>
</ul>
<h2 id="method-visibility"><a href="#method-visibility" class="headerlink" title="method visibility"></a>method visibility</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span></span></div><div class="line">  <span class="comment"># public goes here</span></div><div class="line"></div><div class="line">  protected</div><div class="line">  <span class="comment"># protected goes here</span></div><div class="line">  <span class="comment"># like c++</span></div><div class="line"></div><div class="line">  private</div><div class="line">  <span class="comment"># private goes here</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="inherit"><a href="#inherit" class="headerlink" title="inherit"></a>inherit</h2><p>tips:</p>
<ul>
<li><code>class derive &lt; base</code> only ‘public’ inherit</li>
<li><code>any_class.class # =&gt; Class</code> instance_of <strong>Class</strong></li>
<li><code>any_class.superclass # =&gt; Object</code> subclass_of <strong>Object</strong></li>
</ul>
<h3 id="override"><a href="#override" class="headerlink" title="override"></a>override</h3><ul>
<li><code>alias :super_inv :super_method_to_be_overrided</code> to call method of superclass</li>
<li>only subclass when familiar with it (private methods can be occasionaly overrided!), or encapsulate/delegate if only to use public API</li>
<li>class method also override, better to invoke it through the class which defines it</li>
</ul>
<h3 id="var-1"><a href="#var-1" class="headerlink" title="var"></a>var</h3><ul>
<li>instance var<ul>
<li>not inherited</li>
<li>create on assign(usually done by method invoke)</li>
<li>if same name, that value is <strong>overwritten</strong> not <strong>shadowed</strong></li>
</ul>
</li>
<li>class instance var<ul>
<li>not inherited</li>
</ul>
</li>
<li>class var<ul>
<li>inherited, so alterable in subclass</li>
<li>better to use class instance var instead, to avoid the above case</li>
</ul>
</li>
<li>constant<ul>
<li>bound to lexical scope within method(inherited method use constant of superclass)</li>
</ul>
</li>
</ul>
<h2 id="object-create"><a href="#object-create" class="headerlink" title="object create"></a>object create</h2><ul>
<li><code>clone</code> can keep the frozen state while <code>dup</code> not</li>
<li>both use <code>initialize_copy</code> (consider copy-constructor)</li>
</ul>
<figure class="highlight ruby"><figcaption><span>limit-creation</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">private_class_method <span class="symbol">:new</span>,<span class="symbol">:allocate</span></div><div class="line">private <span class="symbol">:dup</span>,<span class="symbol">:clone</span></div></pre></td></tr></table></figure>
<h2 id="module"><a href="#module" class="headerlink" title="module"></a>module</h2><p>A named group of methods, contants and class vars.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Base64</span></span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">encode</span></span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">decode</span></span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>allow nesting with classes</p>
<h3 id="mixin"><a href="#mixin" class="headerlink" title="mixin"></a>mixin</h3><ol>
<li>module defines bunch of method rely on some class instance methods(as interface)</li>
<li><code>include module</code> in class</li>
<li>define the relied methods</li>
</ol>
<ul>
<li>include module in module</li>
<li><code>object.extend(module)</code> apply on a object</li>
</ul>
<h3 id="loading"><a href="#loading" class="headerlink" title="loading"></a>loading</h3><table>
<thead>
<tr>
<th>term</th>
<th>require</th>
<th>load</th>
</tr>
</thead>
<tbody>
<tr>
<td>allow binary</td>
<td>Y</td>
<td>N</td>
</tr>
<tr>
<td>path</td>
<td>library name</td>
<td>exact filename</td>
</tr>
<tr>
<td>repeat</td>
<td>once</td>
<td>mutiple times</td>
</tr>
<tr>
<td>$SAVE level</td>
<td>0</td>
<td>current</td>
</tr>
</tbody>
</table>
<h3 id="lazyload"><a href="#lazyload" class="headerlink" title="lazyload"></a>lazyload</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># require 'socket' if TCPSocket first used</span></div><div class="line">autoload <span class="symbol">:TCPSocket</span>, <span class="string">"socket"</span></div></pre></td></tr></table></figure>
<h2 id="eigenclass"><a href="#eigenclass" class="headerlink" title="eigenclass"></a>eigenclass</h2><ul>
<li>anonymouse class attached to an object, to open it <code>class &lt;&lt; some; def .. end end</code></li>
<li><code>class &lt;&lt; class_name</code> define class method of class_name or within class def <code>class &lt;&lt; self</code></li>
<li><code>class &lt;&lt; object</code> define singleton method of object</li>
</ul>
<h2 id="method-lookup"><a href="#method-lookup" class="headerlink" title="method lookup"></a>method lookup</h2><p>take <code>o.m</code>, search sequently:</p>
<ol>
<li>eigenclass of <code>o</code> for singleton method <code>m</code></li>
<li>instance method <code>m</code></li>
<li>modules (reverse the include order)</li>
<li>inheritance (repeat 2-3)</li>
<li>lookup <code>method_missing</code></li>
</ol>
<h2 id="constant-lookup"><a href="#constant-lookup" class="headerlink" title="constant lookup"></a>constant lookup</h2><ol>
<li>lexical</li>
<li>inheritance: <code>.. -&gt; Object(as top level) -&gt; Kernel</code></li>
</ol>
<p>example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Kernel</span></span></div><div class="line">  <span class="comment"># Constants defined in Kernel</span></div><div class="line">  A = B = C = D = E = F = <span class="string">"defined in kernel"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># Top-level or "global" constants defined in Object</span></div><div class="line">A = B = C = D = E = <span class="string">"defined at toplevel"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span></div><div class="line">  <span class="comment"># Constants defined in a superclass</span></div><div class="line">  A = B = C = D = <span class="string">"defined in superclass"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Included</span></span></div><div class="line">  <span class="comment"># Constants defined in an included module</span></div><div class="line">  A = B = C = <span class="string">"defined in included module"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Enclosing</span></span></div><div class="line">  <span class="comment"># Constants defined in an enclosing module</span></div><div class="line">  A = B = <span class="string">"defined in enclosing module"</span></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Local</span> &lt; Super</span></div><div class="line">    <span class="keyword">include</span> Included</div><div class="line">    <span class="comment"># Locally defined constant</span></div><div class="line">    A = <span class="string">"defined locally"</span></div><div class="line">    <span class="comment"># The list of modules searched, in the order searched</span></div><div class="line">    <span class="comment"># [Enclosing::Local, Enclosing, Included, Super, Object, Kernel]</span></div><div class="line">    search = (Module.nesting + <span class="keyword">self</span>.ancestors + Object.ancestors).uniq</div><div class="line">    puts A <span class="comment"># =&gt; "defined locally"</span></div><div class="line">    puts B <span class="comment"># =&gt; "defined in enclosing module"</span></div><div class="line">    puts C <span class="comment"># =&gt; "defined in include module"</span></div><div class="line">    puts D <span class="comment"># =&gt; "defined in superclass"</span></div><div class="line">    puts E <span class="comment"># =&gt; "defined toplevel"</span></div><div class="line">    puts F <span class="comment"># =&gt; "defined kernel"</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-28T13:16:28.000Z"><a href="/2014/11/28/ruby-programming-language-ch6/"><i>2014-11-28</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/28/ruby-programming-language-ch6/">ruby programming language(ch6)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Ch6"><a href="#Ch6" class="headerlink" title="Ch6"></a>Ch6</h1><h2 id="method"><a href="#method" class="headerlink" title="method"></a>method</h2><h3 id="singleton-method"><a href="#singleton-method" class="headerlink" title="singleton method"></a>singleton method</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">o = <span class="string">"some object"</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">o</span>.<span class="title">echo</span></span></div><div class="line">  puts <span class="keyword">self</span></div><div class="line"><span class="keyword">end</span></div><div class="line">o.echo <span class="comment"># invoke</span></div></pre></td></tr></table></figure>
<h3 id="alias"><a href="#alias" class="headerlink" title="alias"></a>alias</h3><p><code>alias &lt;new&gt; &lt;origin&gt;</code></p>
<p>take an example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span></div><div class="line">  <span class="comment"># ..</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">alias</span> real_foo foo</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span></div><div class="line">  <span class="comment"># ..</span></div><div class="line">  real_foo <span class="comment"># it's ok</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h3 id="default-argument"><a href="#default-argument" class="headerlink" title="default argument"></a>default argument</h3><ul>
<li>default arguments must be <strong>adjacent</strong></li>
<li>left-to-right assign</li>
</ul>
<h3 id="block-as-argument"><a href="#block-as-argument" class="headerlink" title="block as argument"></a>block as argument</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(.., &amp;b)</span></span></div><div class="line">  <span class="comment"># ..</span></div><div class="line">  b.call(..) <span class="comment"># &amp;b get to a Proc object, this replaces yield</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<ul>
<li>block argument and real block <strong>cannot</strong> be given at same time</li>
</ul>
<h3 id="proc-as-argument"><a href="#proc-as-argument" class="headerlink" title="proc as argument"></a>proc as argument</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">p = Proc.new &#123;..&#125;</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(.., p)</span></span> <span class="keyword">end</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">(.., &amp;b)</span></span> <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># invoke</span></div><div class="line">foo(.., p)</div><div class="line">foo(.., &amp;p)</div></pre></td></tr></table></figure>
<h3 id="using-amp"><a href="#using-amp" class="headerlink" title="using &amp;"></a>using &amp;</h3><ul>
<li>method symbol has <code>.to_proc</code> to Proc object</li>
<li><code>&amp;</code> before Proc object make it applicapable by iterator, <code>lst.map &amp;:upcase</code></li>
<li><code>&amp;:sym</code> = <code>&amp;:sym.to_proc</code> in invocation</li>
</ul>
<h2 id="Proc-amp-Lambda"><a href="#Proc-amp-Lambda" class="headerlink" title="Proc &amp; Lambda"></a>Proc &amp; Lambda</h2><ul>
<li>both <code>is-a</code> <strong>Proc</strong></li>
<li>== only via <code>dup,clone</code></li>
</ul>
<h3 id="create-proc"><a href="#create-proc" class="headerlink" title="create proc"></a>create proc</h3><p>from block:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeproc</span><span class="params">(&amp;p)</span></span></div><div class="line">  p</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>or:</p>
<ul>
<li><code>Proc.new</code></li>
<li>lambda<ul>
<li><code>succ = lambda {|x| x+1}</code></li>
<li><code>succ = -&gt;(x){ x+1 }</code></li>
<li><code>f = -&gt;(x,y; i,j,k) {..}</code> or <code>f = -&gt; x,y; i,j,k {..}</code> arg: x,y; local-var: i,j,k (minial lambda: <code>-&gt;{}</code>)</li>
</ul>
</li>
</ul>
<h3 id="invoke"><a href="#invoke" class="headerlink" title="invoke"></a>invoke</h3><p>for both proc and lambda:</p>
<ul>
<li><code>f.call (..)</code></li>
<li><code>f[..]</code></li>
<li><code>f.(..)</code></li>
</ul>
<h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3><h4 id="return"><a href="#return" class="headerlink" title="return"></a>return</h4><p>proc:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeproc</span><span class="params">(msg)</span></span></div><div class="line">  p = Proc.new &#123; puts msg; <span class="keyword">return</span> &#125; <span class="comment"># return to makeproc</span></div><div class="line">  puts <span class="string">"return from proc"</span></div><div class="line">  p   <span class="comment"># but already return to caller(here test)</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span></span></div><div class="line">  puts <span class="string">"enter method"</span></div><div class="line">  p = makeproc <span class="string">"enter proc"</span></div><div class="line">  p.call</div><div class="line">  puts <span class="string">"exit method"</span>  <span class="comment"># so never executed</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">test</div><div class="line"><span class="comment"># enter method</span></div><div class="line"><span class="comment"># return from proc</span></div><div class="line"><span class="comment"># enter proc</span></div><div class="line"><span class="comment"># &gt;&gt; LocalJumpError</span></div></pre></td></tr></table></figure>
<p>lambda:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">makelambda</span><span class="params">(msg)</span></span> .. <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span> .. <span class="title">end</span></span></div><div class="line"></div><div class="line">test</div><div class="line"><span class="comment"># enter method</span></div><div class="line"><span class="comment"># return from lambda</span></div><div class="line"><span class="comment"># enter lambda</span></div><div class="line"><span class="comment"># exit method</span></div><div class="line"><span class="comment"># (no LocalJumpError)</span></div></pre></td></tr></table></figure>
<h4 id="break"><a href="#break" class="headerlink" title="break"></a>break</h4><ul>
<li>proc: as block break out whole iterator</li>
<li>lambda: normal break, only make sense within enclosing loop or iteration</li>
</ul>
<h4 id="arguments"><a href="#arguments" class="headerlink" title="arguments"></a>arguments</h4><ul>
<li>proc: no number match, auto pack/unpack, life easier</li>
<li>lambda: exact match, no auto splat</li>
</ul>
<h2 id="closure"><a href="#closure" class="headerlink" title="closure"></a>closure</h2><ul>
<li>proc and lambda are <strong>closures</strong></li>
<li>closure possess the <strong>copy</strong> of local context when <strong>created</strong></li>
<li>alter via binding: <ol>
<li><code>def foo(n); lambda {..}; end</code></li>
<li>then <code>f2 = foo(2)</code> </li>
<li>f2 can altered to <code>eval(&quot;n=3&quot;, f2)</code> or <code>eval(&quot;n=3&quot;, f2.binding)</code> (complete form)</li>
</ol>
</li>
</ul>
<h2 id="method-object"><a href="#method-object" class="headerlink" title="method object"></a>method object</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">m = <span class="number">0</span>.method <span class="symbol">:succ</span></div><div class="line"></div><div class="line">m.call <span class="keyword">or</span> m[]</div></pre></td></tr></table></figure>
<p><strong>not</strong> closure</p>
<p>unbound method object:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">unbound_plus = Fixnum.instance_method <span class="string">"+"</span></div><div class="line">plus_2 = unbound_plus.bind <span class="number">2</span></div><div class="line">plus_2[<span class="number">2</span>] <span class="comment"># =&gt; 4</span></div><div class="line">plus_3 = plus_2.unbound.bind <span class="number">3</span></div></pre></td></tr></table></figure>
<h2 id="functional"><a href="#functional" class="headerlink" title="functional"></a>functional</h2><h3 id="enumerable-as-example"><a href="#enumerable-as-example" class="headerlink" title="enumerable as example"></a>enumerable as example</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Functional</span></span></div><div class="line">  <span class="comment"># some_method | enumerable: apply some_method to enumerable as map</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span><span class="params">(enum)</span></span></div><div class="line">    enum.map &amp;<span class="keyword">self</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="keyword">alias</span> <span class="params">| apply</span></div><div class="line"></div><div class="line">  # some_method &lt;= enumerable: .. as reduce</div><div class="line">  def reduce(enum)</div><div class="line">    enum.inject &amp;<span class="keyword">self</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  <span class="keyword">alias</span> &lt;= reduce</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"># mixin to Proc &amp; Method</div><div class="line"><span class="keyword">class</span> Proc; <span class="keyword">include</span> Functional; <span class="keyword">end</span></div><div class="line"><span class="keyword">class</span> Method; <span class="keyword">include</span> Functional; <span class="keyword">end</span></div><div class="line"></div><div class="line"># take standard deriv as example</div><div class="line">stddev = -&gt; a &#123; </div><div class="line">  sum = -&gt; x,y &#123; x+y &#125;</div><div class="line">  mean = (sum &lt;= a) / a.size # <span class="keyword">if</span> you want to make it lambda, should <span class="keyword">ensure</span> it can refer `a` <span class="keyword">in</span> invoking deriv</div><div class="line">  deriv = -&gt; x &#123; x - mean &#125;</div><div class="line">  square = -&gt; x &#123; x*x &#125;</div><div class="line">  Math.sqrt( (sum &lt;= square|(deriv<span class="params">|a)) / (a.size - 1) ) </span></div><div class="line">&#125;</div><div class="line"></div><div class="line">stddev[[1,2,3,4]]</div><div class="line"># =&gt; 1.2909944487358056</div></pre></td></tr></table></figure>
<h3 id="compose"><a href="#compose" class="headerlink" title="compose"></a>compose</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">compose</span> <span class="title">f</span></span></div><div class="line">  <span class="keyword">if</span> <span class="keyword">self</span>.respond_to?(<span class="symbol">:arity</span>) &amp;&amp; <span class="keyword">self</span>.arity == <span class="number">1</span></div><div class="line">    -&gt; &#123;<span class="params">|*args|</span> <span class="keyword">self</span>[f[*args]]&#125;</div><div class="line">  <span class="keyword">else</span></div><div class="line">    -&gt; &#123;<span class="params">|*args|</span> <span class="keyword">self</span>[*f[*args]]&#125; <span class="comment"># handles more than one args, if self is defined like that</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">alias</span> * compose</div></pre></td></tr></table></figure>
<h3 id="partial-apply"><a href="#partial-apply" class="headerlink" title="partial apply"></a>partial apply</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_head</span><span class="params">(*first)</span></span>; -&gt; *rest &#123; <span class="keyword">self</span>[*first.concat rest] &#125;; <span class="keyword">end</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply_tail</span><span class="params">(*last)</span></span>; -&gt; *rest &#123; <span class="keyword">self</span>[*rest.concat last] &#125;; <span class="keyword">end</span></div><div class="line"><span class="keyword">alias</span> <span class="meta">&gt;&gt; </span>apply_head</div><div class="line"><span class="keyword">alias</span> &lt;&lt; apply_tail</div><div class="line"></div><div class="line">g = f <span class="meta">&gt;&gt; </span><span class="number">2</span> <span class="comment"># set 1st arg to 2</span></div><div class="line">g = f &lt;&lt; <span class="number">2</span> <span class="comment"># set last arg to 2</span></div></pre></td></tr></table></figure>
<h3 id="memorize"><a href="#memorize" class="headerlink" title="memorize"></a>memorize</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">memoize</span></span></div><div class="line">  cache = &#123;&#125; <span class="comment"># An empty cache. The lambda captures this in its closure.</span></div><div class="line">  lambda &#123;<span class="params">|*args|</span></div><div class="line">      <span class="comment"># notice that the hash key is the entire array of arguments!</span></div><div class="line">    unless cache.has_key?(args) <span class="comment"># If no cached result for these args</span></div><div class="line">      cache[args] = <span class="keyword">self</span>[*args] <span class="comment"># Compute and cache the result</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    cache[args] <span class="comment"># Return result from cache</span></div><div class="line">  &#125;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="comment"># A (probably unnecessary) unary + operator for memoization</span></div><div class="line"><span class="comment"># Mnemonic: the + operator means "improved"</span></div><div class="line"><span class="keyword">alias</span> +@ memoize <span class="comment"># cached_f = +f @ for prefix unary</span></div></pre></td></tr></table></figure>
<p>example: </p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># recursive</span></div><div class="line">factorial = -&gt;x &#123;..&#125;.memorize <span class="keyword">or</span> +lambda &#123;<span class="params">|x|</span>..&#125; <span class="comment"># ok, cached</span></div><div class="line">factorial = -&gt;x &#123;..&#125;; cached_f = +factorial      <span class="comment"># not cached, only you called each x once, that x is cahced!</span></div></pre></td></tr></table></figure>
<h3 id="with-symbol"><a href="#with-symbol" class="headerlink" title="with symbol"></a>with symbol</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ..</span></div><div class="line"><span class="keyword">alias</span> [] bind</div><div class="line">String[<span class="symbol">:reverse</span>][<span class="string">"hello"</span>][] <span class="comment"># =&gt; "olleh"</span></div><div class="line"><span class="comment">#   unbound     bind-to  invoke</span></div><div class="line"><span class="comment">#   method      "hello"</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-26T07:56:30.000Z"><a href="/2014/11/26/ruby-programming-language-ch4-5/"><i>2014-11-26</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/26/ruby-programming-language-ch4-5/">ruby programming language(ch4-5)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Ch4"><a href="#Ch4" class="headerlink" title="Ch4"></a>Ch4</h1><h2 id="parallel-assign"><a href="#parallel-assign" class="headerlink" title="parallel assign"></a>parallel assign</h2><ul>
<li><code>x,y,z = 1,2,3</code> same as <code>x,y,z = [1,2,3]</code> or <code>x,y,z=*[1,2,3]</code>(splat)</li>
<li>swap: <code>x,y = y,x</code>(like python)</li>
<li>lvalues can only have one splat:<ul>
<li><code>*x,y = 1,2,3</code>  [1,2],3</li>
<li><code>x,y,*z = 1,*[2,3,4]</code> 1,2,[3,4]</li>
<li><code>x,y,z = 1,[2,3]</code> 1,[2,3],nil, but <code>x,y,z=1,*[2,3]</code> 1,2,3</li>
<li><code>*</code> on lvalue as compress, on rvalue as decompress</li>
</ul>
</li>
</ul>
<h2 id="flip-flop"><a href="#flip-flop" class="headerlink" title="flip-flop"></a>flip-flop</h2><ul>
<li><code>(1..10).each {|x| print x if x==3..x&gt;=3}</code> 3 because <code>..</code> does evaluation and righthand expr check(to flop out) at same time</li>
<li><code>(1..10).each {|x| print x if x==3...x&gt;=3}</code> 34 because <code>...</code> waits evaluation first, then check and flop out</li>
</ul>
<h2 id="oneline-expr"><a href="#oneline-expr" class="headerlink" title="oneline expr"></a>oneline expr</h2><ul>
<li><code>(expr) if (expr)</code></li>
<li>(in python <code>(expr) if (expr) else (expr)</code> valid, while not in ruby)</li>
</ul>
<h1 id="Ch5"><a href="#Ch5" class="headerlink" title="Ch5"></a>Ch5</h1><h2 id="condition"><a href="#condition" class="headerlink" title="condition"></a>condition</h2><h3 id="if-modifier"><a href="#if-modifier" class="headerlink" title="if modifier"></a>if modifier</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">begin</span></div><div class="line">  line1</div><div class="line">  line2</div><div class="line"><span class="keyword">end</span> <span class="keyword">if</span> expr</div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">( line1</div><div class="line">  line2 ) <span class="keyword">if</span> expr</div></pre></td></tr></table></figure>
<h3 id="unless"><a href="#unless" class="headerlink" title="unless"></a>unless</h3><ul>
<li>if-not</li>
<li>no allow <code>elsif</code></li>
</ul>
<h3 id="case"><a href="#case" class="headerlink" title="case"></a>case</h3><ul>
<li><code>case [when+] end</code> no need <code>break</code></li>
<li>can be used as expr value: <code>x = (case .. end)</code></li>
</ul>
<h3 id="while-until-as-modifier"><a href="#while-until-as-modifier" class="headerlink" title="while/until as modifier"></a>while/until as modifier</h3><ul>
<li><code>expr while(until) expr</code></li>
<li>or as <code>if</code></li>
</ul>
<h2 id="iterate"><a href="#iterate" class="headerlink" title="iterate"></a>iterate</h2><ul>
<li>integral: <code>.upto</code>, <code>.downto</code>, <code>.times</code></li>
<li><p>continous: <code>start.step(end, step)</code></p>
</li>
<li><p><code>.collect</code> (like <code>.map</code>?) traversal and process each</p>
</li>
<li><code>.select</code> out subset meet requirements, <code>.reject</code> as inverse</li>
<li><code>.inject</code> as reduce</li>
</ul>
<h3 id="custom"><a href="#custom" class="headerlink" title="custom"></a>custom</h3><ul>
<li><code>yield</code> values to block as parameter, say invoke the block with yielded values</li>
<li><code>if block_given?</code> to determine whether invoke or not</li>
<li>return as enumerator: <code>self.to_enum(:yout_yield_method)</code>, which can then invoke <code>.each</code>, etc.</li>
<li>as external iterator: <code>loop {iterator.next}</code>, which raise <strong>StopIteration</strong></li>
</ul>
<h2 id="alter-control-flow"><a href="#alter-control-flow" class="headerlink" title="alter control flow"></a>alter control flow</h2><ul>
<li><code>return</code>: allow return multi values from block, but jumps out of current enclosing method, thus return values as method values</li>
<li><code>break</code>: like <code>return</code> can have a value, but jumps out of whole iteration but not method scope</li>
<li><code>next</code>: allow return values, jumps out current iteration</li>
<li><code>redo</code>: restart current iteration, skipping checking the condition</li>
</ul>
<h2 id="exception"><a href="#exception" class="headerlink" title="exception"></a>exception</h2><h3 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h3><ul>
<li><code>raise &quot;bad argument&quot; if &lt;cond&gt;</code></li>
<li><code>raise RuntimeError, &quot;bad argument&quot; if &lt;cond&gt;</code></li>
<li><code>raise RuntimeError.new &quot;bad argument&quot; if &lt;cond&gt;</code></li>
<li><code>raise RuntimeError.exception &quot;bad argument&quot; if &lt;cond&gt;</code></li>
</ul>
<h3 id="rescue"><a href="#rescue" class="headerlink" title="rescue"></a>rescue</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">begin</span></div><div class="line">  <span class="comment"># code may raise exception</span></div><div class="line"><span class="keyword">rescue</span> =&gt; e <span class="comment"># global var $! also handles it</span></div><div class="line">  <span class="comment"># handle it</span></div><div class="line"><span class="keyword">else</span> </div><div class="line">  <span class="comment"># other uncatched</span></div><div class="line"><span class="keyword">ensure</span></div><div class="line">  <span class="comment"># always run</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>variables in <code>rescue</code> scope are visiable to rest after</p>
<ul>
<li><code>rescue Exception</code></li>
<li><code>rescue ArgumentError =&gt; e</code></li>
<li><code>rescue ArgumentError, TypeError =&gt; e</code> or-match</li>
</ul>
<p>as modifier: <code>y = factorial(x) rescue 0</code>, handles any <strong>StandardError</strong> and return the default follows <code>rescue</code></p>
<h2 id="BEGIN-END"><a href="#BEGIN-END" class="headerlink" title="BEGIN/END"></a>BEGIN/END</h2><ul>
<li><code>BEGIN {..}</code> executes before anything else only once without considering conditions</li>
<li><code>END {..}</code> consider conditions; first register(encounter), last execute; only once even in loop</li>
</ul>
<hr>
<h2 id="thread"><a href="#thread" class="headerlink" title="thread"></a>thread</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">readfiles</span><span class="params">(filenames)</span></span></div><div class="line">  threads = filenames.map <span class="keyword">do</span> <span class="params">|f|</span></div><div class="line">    Thread.new &#123; File.read(f) &#125; <span class="comment"># return value of block stores in thread.value, which is a sync method(will block if not complete)</span></div><div class="line">  <span class="keyword">end</span></div><div class="line">  threads.map &#123;<span class="params">|t|</span> t.value&#125;</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="fiber"><a href="#fiber" class="headerlink" title="fiber"></a>fiber</h2><p>lightweight thread</p>
<h3 id="normal"><a href="#normal" class="headerlink" title="normal"></a>normal</h3><ul>
<li><code>require &#39;fiber&#39;</code></li>
<li><code>.yield</code> transfers control back to caller, <code>.resume</code> to return</li>
</ul>
<p>example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">f = Fiber.new &#123;</div><div class="line">  puts <span class="string">"fiber hel"</span>  <span class="comment"># 3.</span></div><div class="line">  Fiber.<span class="keyword">yield</span>       <span class="comment"># 4. goto line 9</span></div><div class="line">  puts <span class="string">"fiber bye"</span>  <span class="comment"># 7. goto line 11</span></div><div class="line">&#125;</div><div class="line">  </div><div class="line">puts <span class="string">"caller hel"</span>   <span class="comment"># 1.</span></div><div class="line">f.resume            <span class="comment"># 2. goto line 2</span></div><div class="line">puts <span class="string">"caller bye"</span>   <span class="comment"># 5.</span></div><div class="line">f.resume            <span class="comment"># 6. goto line 4</span></div><div class="line"><span class="comment"># end</span></div><div class="line">  </div><div class="line"><span class="comment"># results:</span></div><div class="line"><span class="comment"># caller hel</span></div><div class="line"><span class="comment"># fiber hel</span></div><div class="line"><span class="comment"># caller bye</span></div><div class="line"><span class="comment"># fiber bye</span></div></pre></td></tr></table></figure>
<p>diff with <code>yield</code> in iteration:</p>
<ul>
<li>fiber yields to caller</li>
<li>iter yields to block</li>
</ul>
<h3 id="with-arguments-amp-return-values"><a href="#with-arguments-amp-return-values" class="headerlink" title="with arguments &amp; return values"></a>with arguments &amp; return values</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">f = Fiber.new <span class="keyword">do</span> <span class="params">|msg|</span></div><div class="line">  puts <span class="string">"caller: <span class="subst">#&#123;msg&#125;</span>"</span></div><div class="line">  msg2 = Fiber.<span class="keyword">yield</span> <span class="string">"hel"</span></div><div class="line">  puts <span class="string">"caller: <span class="subst">#&#123;msg2&#125;</span>"</span></div><div class="line">  <span class="string">"fine"</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">response = f.resume <span class="string">"hel"</span></div><div class="line">puts <span class="string">"fiber: <span class="subst">#&#123;response&#125;</span>"</span></div><div class="line">response2 = f.resume <span class="string">"how are you"</span> <span class="comment"># "how are you" as the value of Fiber.yield</span></div><div class="line">puts <span class="string">"fiber: <span class="subst">#&#123;response2&#125;</span>"</span></div><div class="line"></div><div class="line"><span class="comment"># results:</span></div><div class="line"><span class="comment"># caller: hel</span></div><div class="line"><span class="comment"># fiber: hel</span></div><div class="line"><span class="comment"># caller: how are you</span></div><div class="line"><span class="comment"># fiber: fine</span></div></pre></td></tr></table></figure>
<h3 id="transfer"><a href="#transfer" class="headerlink" title="transfer"></a>transfer</h3><p>unlike thread, fibers must be explicitly scheduled via <code>transfer</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f = Fiber.new &#123;<span class="params">|..|</span> g.transfer(..)&#125; <span class="comment"># transfer contorl from f to g with arguments</span></div><div class="line">g = Fiber.new &#123;..&#125;</div></pre></td></tr></table></figure>
<h2 id="continuation"><a href="#continuation" class="headerlink" title="continuation"></a>continuation</h2><p>performs jump(goto)</p>
<p>take example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">$line = &#123;&#125; <span class="comment"># global hash for store jump lables</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">line</span><span class="params">(symbol)</span></span></div><div class="line">  callcc &#123;<span class="params">|c|</span> $lines[symbol] = c&#125; <span class="comment"># make a continuation related to label</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">goto</span><span class="params">(symbol)</span></span></div><div class="line">  $lines[symbol].call <span class="comment"># return to caller label</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># now applying goto</span></div><div class="line">i = <span class="number">0</span></div><div class="line">line <span class="number">10</span> <span class="comment"># 10 is a label can be anyone else</span></div><div class="line">puts i += <span class="number">1</span></div><div class="line">goto <span class="number">10</span> <span class="keyword">if</span> i &lt; <span class="number">5</span> <span class="comment"># jump</span></div><div class="line"></div><div class="line">line <span class="number">20</span> <span class="comment"># same</span></div><div class="line">puts i -= <span class="number">1</span></div><div class="line">goto <span class="number">20</span> <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="comment"># jump</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-26T05:30:56.000Z"><a href="/2014/11/26/ruby-programming-language-ch3/"><i>2014-11-26</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/26/ruby-programming-language-ch3/">ruby programming language(ch3)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Ch3"><a href="#Ch3" class="headerlink" title="Ch3"></a>Ch3</h1><h2 id="number"><a href="#number" class="headerlink" title="number"></a>number</h2><pre><code>Numeric -- Integer
    |         |-- Fixnum
    |         `-- Bignum
    |----- Float
    |----- Complex*
    |----- BigDecimal*
    `----- Rational*
(* as standard lib of ruby, rest built-in)
</code></pre><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="number">1_000_000</span> == <span class="number">1000000</span></div><div class="line">-<span class="number">7</span>%<span class="number">3</span> == <span class="number">2</span> <span class="comment"># in ruby, sign comply with 2nd operand; C,Java etc. the 1st. </span></div><div class="line">-a/b == b/-a != -(a/b) <span class="comment"># ruby round to negative inf; C,Java not.</span></div></pre></td></tr></table></figure>
<h2 id="text"><a href="#text" class="headerlink" title="text"></a>text</h2><h3 id="single-quote"><a href="#single-quote" class="headerlink" title="single-quote"></a>single-quote</h3><ul>
<li><code>\</code> escape only <code>\</code> and <code>&#39;</code>, thus <code>a\b</code> == <code>a\\b</code></li>
<li><code>&#39;.. \&lt;NL&gt; ..&#39;</code> has two lines, <code>\</code> <strong>NOT</strong> escape <code>\n</code></li>
<li><code>&#39;..&#39;\&lt;NL&gt;&#39;..&#39;</code> concat lines, no introducing <code>\n</code></li>
</ul>
<h3 id="double-quote"><a href="#double-quote" class="headerlink" title="double-quote"></a>double-quote</h3><ul>
<li>escape char<ul>
<li><code>\u{code1 code2 ..}</code> escape multi unicode char at one time <strong>WITHOUT</strong> space</li>
</ul>
</li>
<li>contnue line as single-quote</li>
</ul>
<h3 id="generalized-quoting"><a href="#generalized-quoting" class="headerlink" title="generalized quoting"></a>generalized quoting</h3><ul>
<li><code>%q(.. no need escape here ..)</code>, <code>()</code> can be any matched <code>[]</code>, <code>{}</code>, <code>&lt;&gt;</code>, if not well-matched, <strong>NEED</strong> escape the delim</li>
<li><code>%Q</code> the same</li>
<li><code>%q_.. escape _ with \_ .._</code>, in case close delim (here <code>_</code>, others <code>!</code>, <code>-</code> also work) the same with open one</li>
</ul>
<h3 id="here-doc"><a href="#here-doc" class="headerlink" title="here doc"></a>here doc</h3><p><code>&lt;&lt;[end delim](e.g. EOF, __HERE__)</code>, no space in between <code>&lt;&lt;</code> and <code>[end delim]</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">s = &lt;&lt;HERE + &lt;&lt;THERE + <span class="string">"end"</span></div><div class="line">here</div><div class="line">HERE</div><div class="line">there</div><div class="line">THERE</div><div class="line"><span class="comment"># s = "here\nthere\nend"</span></div></pre></td></tr></table></figure>
<ul>
<li><code>&lt;&lt;-[end delim]</code> allow spaces before <code>[end delim]</code></li>
<li>allow spaces in <code>[end delim]</code>, e.g. <code># # #</code></li>
</ul>
<h3 id="shell-command"><a href="#shell-command" class="headerlink" title="shell command:"></a>shell command:</h3><ul>
<li><code>`&lt;shell-cmd&gt;` </code> replace with command output</li>
<li><code>%x&lt;shell-cmd&gt;</code> , either</li>
</ul>
<p>example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">listcmd = win ? <span class="string">'dir'</span><span class="symbol">:<span class="string">'ls'</span></span></div><div class="line">listing = <span class="string">`<span class="subst">#&#123;listcmd&#125;</span>`</span></div><div class="line"><span class="comment"># or</span></div><div class="line">listing = Kernel.<span class="string">`(listcmd)</span></div></pre></td></tr></table></figure>
<h3 id="single-char"><a href="#single-char" class="headerlink" title="single char"></a>single char</h3><ul>
<li><code>?&lt;ch&gt;</code>, <code>&lt;ch&gt;</code> can be any ascii code or unicode <code>\uxxx</code> or oct or hex or <code>\C-x</code>(ctrl-x, other similarly)</li>
</ul>
<h3 id="operation-on-string"><a href="#operation-on-string" class="headerlink" title="operation on string"></a>operation on string</h3><ul>
<li><code>&lt;&lt;</code> to append, <code>*</code> to repeat</li>
<li><code>[]</code> index the exact unicode char <strong>NOT</strong> the codes in bytes<ul>
<li><code>[] = ?x</code> change with single char</li>
<li><code>[] = &quot;..&quot;</code> with string</li>
<li><code>[]</code> can be any integral pos(positive/negative), range, or regex</li>
</ul>
</li>
<li><code>&lt;string&gt;.size == &lt;string&gt;.length ?= &lt;string&gt;.bytesize(care unicode)</code></li>
</ul>
<h2 id="array"><a href="#array" class="headerlink" title="array"></a>array</h2><ul>
<li><code>%w</code> like <code>%q</code> create array literal in <strong>STRING</strong></li>
<li><code>&lt;array&gt;.size == &lt;array&gt;.length</code></li>
</ul>
<h3 id="operation"><a href="#operation" class="headerlink" title="operation"></a>operation</h3><ul>
<li><code>+</code>: concat <strong>BOTH</strong> array</li>
<li><code>-</code>: set diff</li>
<li><code>&lt;&lt;</code>: append</li>
<li><code>*</code>: repeat</li>
<li><code>|</code>: union (order kept)</li>
<li><code>&amp;</code>: intersect (order kept)</li>
<li><code>[]</code>: access, slice, assign as string</li>
</ul>
<h2 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h2><p>simple symbol style representation:</p>
<p><code>numbers = { one: 1, two: 2, three: 3}</code></p>
<p>complex:</p>
<p><code>numbers = {:one =&gt; 1, :two =&gt; 2, :three =&gt; 3}</code> <strong>DIFF</strong> with <code>numbers = {&quot;one&quot; =&gt; 1, &quot;two&quot; =&gt; 2, &quot;three&quot; =&gt; 3}</code></p>
<ul>
<li>hash keys compare with <code>eql?</code>(<code>==</code> in most cases)</li>
<li>if <code>eql?</code> not provided, <strong>object_id</strong> is used via <code>hash</code> method; if <code>hash</code> not provided, that cannot be a hash key</li>
<li>hashcode of mutable object changes when its content changes, thus hashes corrupt; or <code>rehash</code> to rescue</li>
<li><code>sring</code> is a special case handled though it’s mutable</li>
</ul>
<h2 id="range"><a href="#range" class="headerlink" title="range"></a>range</h2><p><strong>!=</strong> array</p>
<ul>
<li>literals<ul>
<li><code>a..b</code>: [a,b]</li>
<li><code>a..b</code>: [a, b)</li>
</ul>
</li>
<li>variables:<ul>
<li><code>x..x*2</code></li>
</ul>
</li>
</ul>
<p>only discrete range is iteratable, otherwise use <code>range.step() {..}</code></p>
<p>conv:</p>
<ul>
<li><code>r.to_s</code>, <code>r.to_a</code></li>
<li>care the trap: <code>1..3.to_a</code></li>
</ul>
<h3 id="membership"><a href="#membership" class="headerlink" title="membership"></a>membership</h3><ul>
<li><code>.member?</code> == <code>.include?</code></li>
<li><code>.cover?</code> check if fit in the (dict-)sorted list from range_begin to range_end, so it <strong>ALWAYS</strong> use continous test, while <code>.member?</code> and <code>.include?</code> use continous when range ends are numbers, or fall to discreate when not numeric:<ul>
<li><code>triples = &quot;AAA&quot;..&quot;ZZZ&quot;</code></li>
<li><code>triples.include? &quot;ABC&quot;</code>: true and slow</li>
<li><code>triples.include? &quot;ABCD&quot;</code>: false and slow</li>
<li><code>triples.cover? &quot;ABCD&quot;</code>: true and fast</li>
</ul>
</li>
</ul>
<h3 id="flip-flop-Ch4"><a href="#flip-flop-Ch4" class="headerlink" title="flip-flop (@Ch4)"></a>flip-flop (@Ch4)</h3><p>take an example:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">DATA.each <span class="keyword">do</span> <span class="params">|line|</span></div><div class="line">  <span class="keyword">if</span> line =~ <span class="regexp">/start/</span> .. line =~ <span class="regexp">/end/</span></div><div class="line">    puts line</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment"># prints line between "start" and "end"(include), so flip-flop works with STATE memory</span></div></pre></td></tr></table></figure>
<h2 id="symbol"><a href="#symbol" class="headerlink" title="symbol"></a>symbol</h2><p>equal representation:</p>
<ul>
<li><code>:sym</code></li>
<li><code>:&quot;sym&quot;</code>, quote also can be used as <code>:&quot;s y m&quot;</code> to include spaces</li>
<li><code>:&quot;#{s}&quot; # s = &quot;sym&quot;</code></li>
<li><code>%s[sym]</code></li>
</ul>
<p>conv:</p>
<ul>
<li>to string: <code>.to_s</code>, <code>.id2name</code></li>
<li>from_string: <code>.to_sym</code>, <code>.intern</code></li>
</ul>
<p>reflective:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> o.respond_to? <span class="symbol">:size</span></div><div class="line">  o.send name</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<h2 id="object"><a href="#object" class="headerlink" title="object"></a>object</h2><h3 id="true-false"><a href="#true-false" class="headerlink" title="true/false"></a>true/false</h3><ul>
<li>only <code>nil</code> and <code>false</code> give <strong>LOGICAL</strong> false if <code>if</code>, while <code>0</code>, <code>&quot;&quot;</code> give true</li>
<li><code>a &amp;&amp; b</code> gives:<ul>
<li><code>a</code> if a is <code>nil</code> or <code>false</code></li>
<li><code>b</code> otherwise</li>
</ul>
</li>
<li><code>=</code> is prior to <code>and</code>, <code>or</code>, so <code>if a = foo and b = bar</code> is ok, while not work with <code>&amp;&amp;</code>, <code>||</code></li>
</ul>
<h3 id="type"><a href="#type" class="headerlink" title="type"></a>type</h3><ul>
<li><code>x.class</code>, <code>instance_of?</code> exact class, <strong>NO</strong> inheritance check</li>
<li><code>is_a?</code>, <code>kind_of?</code> works with inheritance and mixin</li>
</ul>
<h3 id="equality"><a href="#equality" class="headerlink" title="equality"></a>equality</h3><ul>
<li><code>equal?</code> check exact object reference(object_id)</li>
<li><code>==</code> content identical, has casting, usually override<ul>
<li>array: # same, each item compare with <code>==</code></li>
<li>hash: # of k-v same, key compare with <code>eql?</code>, value with <code>==</code></li>
</ul>
</li>
<li><code>eql?</code> strict version of <code>==</code>, no casting, <code>eql?</code> requires <code>hash</code> method return same value, so must rewrite <code>hash</code> when define <code>eql?</code></li>
<li><code>===</code> <em>case</em> equality<ul>
<li>most classes define <code>===</code> using <code>==</code></li>
<li><code>(1..10) === 5</code> true</li>
<li><code>/\d+/ === 123</code> true</li>
<li><code>String === &quot;s&quot;</code> true</li>
</ul>
</li>
<li><code>=~</code> defined by <strong>String</strong> and <strong>Regexp</strong>, <strong>Object</strong> always return false; <code>!~</code> as inverse</li>
<li><code>&lt;=&gt;</code> if less, -1; elif equal, 0; else 1</li>
</ul>
<h3 id="cast"><a href="#cast" class="headerlink" title="cast"></a>cast</h3><p>on <strong>coerce</strong>:</p>
<p>take example:</p>
<ol>
<li><code>1.5 * Rational(1,3)</code>, equals to <code>(1.5).*(Rational(1,3))</code>, Float * Rational</li>
<li>invoke <code>Rational(1,3).coerce(1.5)</code>, since <code>1.5</code> does not know about <code>Rational(1,3)</code></li>
<li>result as array <code>[Rational(1.5), Rational(1,3)]</code> where <code>1.5</code> get to Rational</li>
<li>then invoke <code>*</code></li>
<li>useful when customizing class</li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-11-25T14:11:55.000Z"><a href="/2014/11/25/ruby-programming-language-ch1-2/"><i>2014-11-25</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/11/25/ruby-programming-language-ch1-2/">ruby programming language(ch1-2)</a></h1>
  

    </header>
    <div class="entry">
      
        <h1 id="Pre-study"><a href="#Pre-study" class="headerlink" title="Pre-study"></a>Pre-study</h1><h2 id="rvm"><a href="#rvm" class="headerlink" title="rvm"></a>rvm</h2><p>If you need to separate configurations &amp; gems for each ruby project individually, <a href="rvm.io">rvm</a> is a good tool.</p>
<p>install check:</p>
<ul>
<li><code>type -t rvm</code> gives <code>function</code></li>
</ul>
<p>usage notes:</p>
<ul>
<li><code>rvm install ruby &lt;version&gt;</code></li>
<li><code>rvm use &lt;version&gt; --default</code> to set default <code>ruby</code> to use</li>
<li><code>rvm gemset use &lt;group&gt;</code> and then <code>gem install &lt;gem&gt;</code> to install gem to that <code>group</code><ul>
<li>gems installed to <code>global</code> are inheritable</li>
</ul>
</li>
</ul>
<p>some tips:</p>
<ul>
<li>make sure your term enable <strong>login-shell</strong></li>
<li>source rvm at last as possible to avoid warning: <code>...path/to/ruby-bin not at first place in PATH...</code></li>
</ul>
<h2 id="pry"><a href="#pry" class="headerlink" title="pry"></a>pry</h2><p>Interactive tool like <code>bpython</code>, i use <code>pry --simple-prompt</code> for convenient like noob test, etc.</p>
<h2 id="ri"><a href="#ri" class="headerlink" title="ri"></a>ri</h2><p>Ruby manual, e.g: <code>ri Array</code>, <code>ri Array.sort</code>, <code>ri Hash#each</code>, <code>ri Math::sqrt</code>.</p>
<hr>
<h1 id="Ch2"><a href="#Ch2" class="headerlink" title="Ch2"></a>Ch2</h1><h2 id="comments"><a href="#comments" class="headerlink" title="comments"></a>comments</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># line comment</span></div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">=begin</span></div><div class="line">block comment</div><div class="line">=end</div></pre></td></tr></table></figure>
<ul>
<li>there’s no <code>/* */</code> like comment.</li>
<li><code>#</code> is prior to <code>=begin(end)</code></li>
</ul>
<h2 id="some-symbol-in-identifiers"><a href="#some-symbol-in-identifiers" class="headerlink" title="some symbol in identifiers"></a>some symbol in identifiers</h2><p>prefix/suffix:</p>
<ul>
<li><code>$</code>: global var</li>
<li><code>@</code>: class instance var</li>
<li><code>@@</code>: class var</li>
<li><code>xx?</code>: boolean-valued method</li>
<li><code>xx!</code>: in-place method</li>
<li><code>xx=</code>: method invoked by assignment</li>
</ul>
<p>reserved word:</p>
<ul>
<li><code>__LINE__</code></li>
<li><code>__ENCODING__</code></li>
<li><code>__FILE__</code></li>
<li><code>__END__</code>: after goes the data, you can refer these data by <code>DATA</code></li>
</ul>
<h2 id="spaces"><a href="#spaces" class="headerlink" title="spaces"></a>spaces</h2><p>one line is implicitly closed if it’s a <strong>complete</strong> expression, check:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">total = x +</div><div class="line">y</div></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">total = x</div><div class="line">+ y</div></pre></td></tr></table></figure>
<p>after ruby1.9, newline start with <code>.</code> implicitly considered as continuel line, like chain-invoke:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">ani = Array.new</div><div class="line">  .push(<span class="string">"doge"</span>)</div><div class="line">  .push(<span class="string">"nya"</span>)</div><div class="line">  .sort</div></pre></td></tr></table></figure>
<p>ruby has grammar candy for method invoke, care the trap:</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">f(<span class="number">3</span>+<span class="number">2</span>)+<span class="number">1</span></div><div class="line">f (<span class="number">3</span>+<span class="number">2</span>)+<span class="number">1</span></div></pre></td></tr></table></figure>
<p>use <code>ruby -w</code> to check ambiguous warning.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-03-17T15:59:27.000Z"><a href="/2014/03/17/id3/"><i>2014-03-17</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/17/id3/">id3</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="ID3v1"><a href="#ID3v1" class="headerlink" title="ID3v1"></a>ID3v1</h2><p>size: 128 bytes at eof</p>
<table>
<thead>
<tr>
<th>field</th>
<th>range</th>
<th>size</th>
<th>extra</th>
</tr>
</thead>
<tbody>
<tr>
<td> header</td>
<td>00 -  02</td>
<td>3</td>
<td>“TAG”</td>
</tr>
<tr>
<td> title</td>
<td>03 -  32</td>
<td>30</td>
<td></td>
</tr>
<tr>
<td> artist</td>
<td>33 -  62</td>
<td>30</td>
<td></td>
</tr>
<tr>
<td> album</td>
<td>63 -  92</td>
<td>30</td>
<td></td>
</tr>
<tr>
<td> year</td>
<td>93 -  96</td>
<td>4</td>
<td>4 digit</td>
</tr>
<tr>
<td> comment</td>
<td>97 - 126</td>
<td>30(28)</td>
<td><code>track#</code> placed at last 2 byte, if comment over 28 byte then no <code>track#</code></td>
</tr>
<tr>
<td> 0-pad</td>
<td>125 - 125</td>
<td>1</td>
<td><em>optional</em>: only set under <code>28</code>, if set <code>track#</code> placed <code>0</code></td>
</tr>
<tr>
<td> track</td>
<td>126 - 126</td>
<td>1</td>
<td><em>optional</em>: only set under <code>28</code>, placed <code>track#</code>; invalid when <code>0-pad</code> not <code>0</code></td>
</tr>
<tr>
<td> genre</td>
<td>127 - 127</td>
<td>1</td>
<td>index in list of genres, or <code>255</code></td>
</tr>
</tbody>
</table>
<h2 id="ID3v2"><a href="#ID3v2" class="headerlink" title="ID3v2"></a>ID3v2</h2><ul>
<li><em>variable</em> size</li>
<li>usually place at start of file, yet allow end or combined, follow <a href="http://id3.org/id3v2.4.0-struture" target="_blank" rel="external">id3.org</a> spec:<blockquote>
<ol>
<li>Prepend the tag.</li>
<li>Prepend a tag with all vital information and add a second tag at<br>  the end of the file, before tags from other tagging systems. The<br>  first tag is required to have a SEEK frame.</li>
<li>Add a tag at the end of the file, before tags from other tagging<br>  systems. </li>
</ol>
</blockquote>
</li>
<li>detect approach:<blockquote>
<ol>
<li>Look for a prepended tag using the pattern: <code>$49 44 33 yy yy xx zz zz zz zz</code>, <code>$49 44 33</code> - <code>&#39;ID3&#39;</code>, <code>$yy &lt; $ff</code> - version number, <code>$xx</code> - flag, <code>$zz &lt; $80</code> - size</li>
<li>If a SEEK frame was found, use its values to guide further<br>   searching.</li>
<li>Look for a tag footer, scanning from the back of the file.</li>
</ol>
</blockquote>
</li>
<li>consist of <em>frame</em></li>
</ul>
<h3 id="ID3v2-2"><a href="#ID3v2-2" class="headerlink" title="ID3v2.2:"></a>ID3v2.2:</h3><ul>
<li>considered obsolete</li>
</ul>
<h3 id="ID3v2-3"><a href="#ID3v2-3" class="headerlink" title="ID3v2.3"></a>ID3v2.3</h3><ul>
<li>most widely used</li>
<li>allow multi-values in a frame, <code>&#39;/&#39;</code> character to separate</li>
</ul>
<h3 id="ID3v2-4"><a href="#ID3v2-4" class="headerlink" title="ID3v2.4"></a>ID3v2.4</h3><ul>
<li>utf-8 support</li>
<li>separate character: from <code>&#39;/&#39;</code> to <code>null byte</code></li>
</ul>
<h3 id="tag-header"><a href="#tag-header" class="headerlink" title="tag header"></a>tag header</h3><p>size: 10 bytes</p>
<table>
<thead>
<tr>
<th>field</th>
<th>range</th>
<th>size</th>
<th>extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>header</td>
<td>00 - 02</td>
<td>3</td>
<td>“ID3”</td>
</tr>
<tr>
<td>ver_major</td>
<td>03 - 03</td>
<td>1</td>
<td>V2.3: 03; V2.4: 04</td>
</tr>
<tr>
<td>ver_minor</td>
<td>04 - 04</td>
<td>1</td>
<td></td>
</tr>
<tr>
<td>flag</td>
<td>05 - 05</td>
<td>1</td>
<td>format as <code>abc00000</code>:<br> a – if unsync<br> b – if has extended head<br> c – if only experimental</td>
</tr>
<tr>
<td>size</td>
<td>06 - 09</td>
<td>4</td>
<td>include <em>frame</em> and <em>extended header</em>, but <strong>NOT</strong> include above 10 bytes of <em>tag header</em><br> format as <code>(0xxxxxx){4}</code>, heighest bit of each byte is 0, <strong>take off</strong> when computing</td>
</tr>
</tbody>
</table>
<h3 id="frame-header"><a href="#frame-header" class="headerlink" title="frame header"></a>frame header</h3><p>size: 10 bytes</p>
<table>
<thead>
<tr>
<th>field</th>
<th>range</th>
<th>size</th>
<th>extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>frame ID</td>
<td>00 - 03</td>
<td>4</td>
<td>frame indicator, referencing ID table</td>
</tr>
<tr>
<td>size</td>
<td>04 - 07</td>
<td>4</td>
<td><strong>NOT</strong> include frame header, <strong>NOT</strong> less than 1<br> format as <code>(xxxxxxxx){4}</code>, all 4 bytes used</td>
</tr>
<tr>
<td>flags</td>
<td>08 - 09</td>
<td>2</td>
<td>format as <code>abc00000 ijk00000</code><br> a – if ignore this frame(by tag)<br> b – if ignore this frame(by file)<br> c – if readonly(generally no one cares)<br> i – if compressed, one byte of two BCD codes<br> j – if encrypt<br> k – group indicator, if in same grousetp with other frame</td>
</tr>
</tbody>
</table>
<h3 id="frame-ID-table"><a href="#frame-ID-table" class="headerlink" title="frame ID table"></a>frame ID table</h3><p>2.4.0:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>field</th>
</tr>
</thead>
<tbody>
<tr>
<td>TDRC</td>
<td>recording date</td>
</tr>
<tr>
<td>TDRL</td>
<td>release date</td>
</tr>
<tr>
<td>TDOR</td>
<td>original release date</td>
</tr>
<tr>
<td>TSOP</td>
<td>artist sort order</td>
</tr>
<tr>
<td>TSOA</td>
<td>album sort order</td>
</tr>
</tbody>
</table>
<p>>= 2.3.0:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>field</th>
</tr>
</thead>
<tbody>
<tr>
<td>TPE1</td>
<td>artist</td>
</tr>
<tr>
<td>TALB</td>
<td>album</td>
</tr>
<tr>
<td>TIT2</td>
<td>title</td>
</tr>
<tr>
<td>TYER</td>
<td>year: ascii number</td>
</tr>
<tr>
<td>TCON</td>
<td>genre: <code>&#39;($genre_no)&#39;</code></td>
</tr>
<tr>
<td>TPOS</td>
<td>disc number</td>
</tr>
<tr>
<td>TRCK</td>
<td>trackno: <code>N(No.#)/M(total#)</code>, both ascii number(means that’s string?)</td>
</tr>
<tr>
<td>TPE2</td>
<td>albumartist</td>
</tr>
<tr>
<td>TSO2</td>
<td>albumartist sort order</td>
</tr>
<tr>
<td>XSOP</td>
<td>artist sort order(obsolete)</td>
</tr>
<tr>
<td>XSOA</td>
<td>album sort order(obsolete)</td>
</tr>
<tr>
<td>TCMP</td>
<td>compilation</td>
</tr>
<tr>
<td>TORY</td>
<td>originaldate</td>
</tr>
<tr>
<td>TCOM</td>
<td>composer</td>
</tr>
<tr>
<td>TPE3</td>
<td>conductor</td>
</tr>
<tr>
<td>TEXT</td>
<td>lyricist</td>
</tr>
<tr>
<td>TPE4</td>
<td>remixer</td>
</tr>
<tr>
<td>TPUB</td>
<td>publisher or label</td>
</tr>
<tr>
<td>TIT3</td>
<td>subtitle</td>
</tr>
<tr>
<td>TMED</td>
<td>media type</td>
</tr>
<tr>
<td>COMM</td>
<td>comment: enc<code>$xx</code>, lang<code>$xx xx xx</code>, short desc ended with <code>$00</code>, actual text<code>&lt;...&gt;</code></td>
</tr>
<tr>
<td>TXXX</td>
<td>user defined text info(see below for details)</td>
</tr>
</tbody>
</table>
<p>obsolete frames 2.2.0:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>field</th>
</tr>
</thead>
<tbody>
<tr>
<td>TP1</td>
<td>artist</td>
</tr>
<tr>
<td>TP2</td>
<td>albumartist</td>
</tr>
<tr>
<td>TAL</td>
<td>album</td>
</tr>
<tr>
<td>TT2</td>
<td>title</td>
</tr>
<tr>
<td>TYE</td>
<td>date</td>
</tr>
<tr>
<td>TCO</td>
<td>genre</td>
</tr>
<tr>
<td>TPA</td>
<td>disc</td>
</tr>
<tr>
<td>TRK</td>
<td>track</td>
</tr>
<tr>
<td>TSP</td>
<td>artist sort order</td>
</tr>
<tr>
<td>TS2</td>
<td>albumartist sort order</td>
</tr>
<tr>
<td>TSA</td>
<td>album sort order</td>
</tr>
<tr>
<td>TCP</td>
<td>compilation</td>
</tr>
<tr>
<td>COM</td>
<td>comment: same as <em>COMM</em> in v2.3 or above</td>
</tr>
</tbody>
</table>
<p>playback staffs:</p>
<ul>
<li>replay gain: labeld as <code>RGAD</code>, <code>RVA2(v2.4)</code> or <code>XRVA(v2.3 compatibility &amp; experimental)</code> in lagacy format</li>
</ul>
<p><strong>Preferred</strong> means to stroe this sort of metadata is use of <em>TXXX</em> key/value pair frame, see below.</p>
<p>TXXX header:</p>
<table>
<thead>
<tr>
<th>field</th>
<th>format</th>
</tr>
</thead>
<tbody>
<tr>
<td>frame ID</td>
<td>“TXXX”</td>
</tr>
<tr>
<td>size</td>
<td><code>$xx xx xx xx</code></td>
</tr>
<tr>
<td>flags</td>
<td><code>$40 $00</code></td>
</tr>
</tbody>
</table>
<p>TXXX frame struct:</p>
<table>
<thead>
<tr>
<th>field</th>
<th>format</th>
</tr>
</thead>
<tbody>
<tr>
<td>encoding</td>
<td><code>$00</code> - iso-8859-1, <code>$01</code> - utf-16 with BOM, <code>$02</code> - utf-16 without BOM, <code>$03</code> - utf-8</td>
</tr>
<tr>
<td>desc</td>
<td><key string=""> ended with <code>$00</code></key></td>
</tr>
<tr>
<td>value</td>
<td><value string=""></value></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>meta</th>
<th>key</th>
<th>value format</th>
</tr>
</thead>
<tbody>
<tr>
<td>track replay gain</td>
<td>“REPLAYGAIN_TARCK_GAIN”</td>
<td><code>[-]a.bb dB</code>: <code>a</code> - integal portion(整数部分) [0-9], <code>bb</code> - decimal portion(小数部分)</td>
</tr>
<tr>
<td>track peak</td>
<td>“REPLAYGAIN_TARCK_PEAK”</td>
<td><code>c.dddddd</code>: <code>c</code> - 0 or 1(1.000000: digital full scale)</td>
</tr>
<tr>
<td>album replay gain</td>
<td>“REPLAYGAIN_ALBUM_GAIN”</td>
<td>-</td>
</tr>
<tr>
<td>album peak</td>
<td>“REPLAYGAIN_ALBUM_PEAK”</td>
<td>-</td>
</tr>
</tbody>
</table>
<!--- vim: set ft=mkd: -->

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>




  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-03-14T12:17:12.000Z"><a href="/2014/03/14/start/"><i>2014-03-14</i></a></time>
      
      
  
    <h1 class="title"><a href="/2014/03/14/start/">start</a></h1>
  

    </header>
    <div class="entry">
      
        <p><img src="http://yyphoto.qiniudn.com/image/wall/sekai-02.jpg" alt="Nagi x Maeda: Owari no Sekai"></p>
<p>新たのブログを作りましたね~</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





<nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav></div></div>
      <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/lang/">lang<span>6</span></a></li>
  
    <li><a href="/categories/life/">life<span>1</span></a></li>
  
    <li><a href="/categories/wiki/">wiki<span>1</span></a></li>
  
  </ul>
</div>



  
<div class="widget tag">
  <h3 class="title title-tag">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/id3tag/">id3tag<span>1</span></a></li>
  
    <li><a href="/tags/mus/">mus<span>2</span></a></li>
  
    <li><a href="/tags/note/">note<span>6</span></a></li>
  
    <li><a href="/tags/quartet/">quartet<span>1</span></a></li>
  
    <li><a href="/tags/ruby/">ruby<span>6</span></a></li>
  
  </ul>
</div>



  
<div class="widget">
  <h3 class="title">Archives</h3>
  <ul class="entry-list"><li class="entry-list-item"><a class="entry-list-link" href="/archives/2017/04/">2017 - 04</a><span class="entry-list-count">1</span></li><li class="entry-list-item"><a class="entry-list-link" href="/archives/2014/12/">2014 - 12</a><span class="entry-list-count">2</span></li><li class="entry-list-item"><a class="entry-list-link" href="/archives/2014/11/">2014 - 11</a><span class="entry-list-count">4</span></li><li class="entry-list-item"><a class="entry-list-link" href="/archives/2014/03/">2014 - 03</a><span class="entry-list-count">2</span></li></ul>
</div>



  
<div class="widget">
  <h3 class="title">About</h3>
  <div class="entry">
    <div id=about>
      <div class="line"><div class="author"></div></div>
      <ul>
        <li><a href="mailto:iranaikimi@gmail.com"><i class="mail"></i><strong>iranaikimi@gmail.com</strong></a></li>
        <li><a href="https://github.com/lythesia"><i class="github"></i><strong>https://github.com/lythesia</strong></a></li>
      </ul>
    </div>
  </div>
</div>


</aside>
      <div class="clearfix"></div>
    
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 lythesia
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/jquery.scrollUp.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'lythesia';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();

  $.scrollUp({scrollText: ''});
})(jQuery);
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


</body>
</html>
